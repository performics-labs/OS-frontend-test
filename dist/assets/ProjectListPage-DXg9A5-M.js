import{a3 as Y,j as e,D as $,x as H,y as W,z as B,E as J,F as V,B as p,aT as X,aU as Z,aV as G,aW as ee,aX as se,aY as te,aZ as ae,a_ as re,a$ as ce,au as ie,b0 as oe,b1 as N,b2 as le,b3 as b,b4 as ne,a1 as m,I as P,d as de,e as ue,b5 as je,b6 as me,b7 as xe,av as h}from"./index-0i5ZKW7Y.js";import{d as pe,u as he,c as ge,f as fe}from"./project-service-ekbUP9Cy.js";const ye=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],D=Y("search",ye);function ve({open:a,onOpenChange:n,title:t,description:j,onSubmit:d,onCancel:o,submitLabel:u="Save",cancelLabel:c="Cancel",isSubmitting:r=!1,isSubmitDisabled:i=!1,children:l}){const g=()=>{o?o():n(!1)};return e.jsx($,{open:a,onOpenChange:n,children:e.jsxs(H,{children:[e.jsxs(W,{children:[e.jsx(B,{children:t}),j&&e.jsx(J,{children:j})]}),e.jsx("div",{className:"space-y-4 py-4",children:l}),e.jsxs(V,{children:[e.jsx(p,{variant:"ghost",onClick:g,disabled:r,type:"button",children:c}),e.jsx(p,{onClick:d,disabled:i||r,type:"submit",children:r?"Saving...":u})]})]})})}function Ce({open:a,onOpenChange:n,onConfirm:t,title:j="Are you sure?",description:d,confirmLabel:o="Delete",cancelLabel:u="Cancel",isDeleting:c=!1,variant:r="destructive"}){return e.jsx(X,{open:a,onOpenChange:n,children:e.jsxs(Z,{children:[e.jsxs(G,{children:[e.jsx(ee,{children:j}),e.jsx(se,{children:d})]}),e.jsxs(te,{children:[e.jsx(ae,{disabled:c,children:u}),e.jsx(re,{onClick:t,disabled:c,className:r==="destructive"?"bg-destructive text-destructive-foreground hover:bg-destructive/90":"",children:c?"Deleting...":o})]})]})})}const y=a=>["projects",a],Ne=(a,n)=>["projects",a,n];function Pe(){const a=ce(),t=ie(i=>i.user)?.user_id,{data:j,isLoading:d,error:o}=oe({queryKey:y(t||""),queryFn:()=>fe(t||""),enabled:!!t}),u=N({mutationFn:i=>{if(!t)throw new Error("User not authenticated");return ge({...i,user_id:t})},onSuccess:()=>{t&&a.invalidateQueries({queryKey:y(t)})}}),c=N({mutationFn:({id:i,data:l})=>he(i,l),onSuccess:(i,l)=>{t&&(a.invalidateQueries({queryKey:y(t)}),a.invalidateQueries({queryKey:Ne(t,l.id)}))}}),r=N({mutationFn:pe,onSuccess:()=>{t&&a.invalidateQueries({queryKey:y(t)})}});return{projects:j?.projects??[],isLoading:d,error:o,createProject:u.mutateAsync,updateProject:c.mutateAsync,deleteProject:r.mutateAsync,isCreating:u.isPending,isUpdating:c.isPending,isDeleting:r.isPending}}function De({onCreateClick:a}){return e.jsxs("div",{className:"flex size-full flex-col items-center justify-center gap-3 p-8 text-center",children:[e.jsx("div",{className:"text-muted-foreground",children:e.jsx(le,{className:"size-16",strokeWidth:1.5})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-sm font-medium",children:"No projects yet"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Create your first project to get started with AI-powered collaboration"})]}),e.jsxs(p,{onClick:a,className:"mt-2",children:[e.jsx(b,{className:"mr-2 size-4"}),"Create Project"]})]})}function Se(){const a=ne(),[n,t]=m.useState(!1),[j,d]=m.useState(!1),[o,u]=m.useState(""),[c,r]=m.useState(""),[i,l]=m.useState(""),[g,f]=m.useState(null),[v,w]=m.useState(null),{projects:S,isLoading:A,createProject:k,updateProject:z,deleteProject:O,isCreating:I,isUpdating:Q,isDeleting:T}=Pe(),x=g!==null,E=()=>{f(null),r(""),l(""),t(!0)},_=s=>{f(s.id),r(s.name),l(s.description||""),t(!0)},L=s=>{w(s),d(!0)},U=async()=>{try{x?(await z({id:g,data:{name:c,description:i}}),h.success("Project updated successfully")):(await k({name:c,description:i}),h.success("Project created successfully")),t(!1),f(null),r(""),l("")}catch(s){const C=s instanceof Error?s.message:"Unknown error occurred";h.error(`Failed to ${x?"update":"create"} project`,{description:C}),console.error(`Project ${x?"update":"creation"} failed:`,s)}},q=async()=>{if(v)try{await O(v),h.success("Project deleted successfully"),d(!1),w(null)}catch(s){const C=s instanceof Error?s.message:"Unknown error occurred";h.error("Failed to delete project",{description:C}),console.error("Project deletion failed:",s)}},K=s=>{a(`/projects/${s}`)},M=s=>{t(s),s||(f(null),r(""),l(""))},F=S.filter(s=>s.name.toLowerCase().includes(o.toLowerCase())||(s.description||"").toLowerCase().includes(o.toLowerCase())),R=S.find(s=>s.id===v);return A?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-auto w-full max-w-4xl space-y-6 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(D,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx(P,{placeholder:"Search projects...",className:"pl-10",disabled:!0,"aria-label":"Search projects"})]}),e.jsxs(p,{disabled:!0,children:[e.jsx(b,{className:"mr-2 size-4"}),"Create Project"]})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(s=>e.jsxs(de,{className:"animate-pulse",children:[e.jsx(ue,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"bg-muted h-5 w-3/4 rounded"}),e.jsx("div",{className:"bg-muted h-4 w-full rounded"}),e.jsx("div",{className:"bg-muted h-4 w-5/6 rounded"})]})}),e.jsx(je,{children:e.jsx("div",{className:"bg-muted h-4 w-1/4 rounded"})})]},s))})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-auto w-full max-w-4xl space-y-6 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(D,{className:"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2"}),e.jsx(P,{placeholder:"Search projects...",className:"pl-10",value:o,onChange:s=>u(s.target.value),"aria-label":"Search projects"})]}),e.jsxs(p,{onClick:E,children:[e.jsx(b,{className:"mr-2 size-4"}),"Create Project"]})]}),F.length>0?e.jsx("div",{className:"grid gap-4 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3",role:"list","aria-label":"Projects list",children:F.map(s=>e.jsx(me,{project:s,onEdit:_,onDelete:L,onClick:K},s.id))}):o?e.jsxs("div",{className:"flex size-full flex-col items-center justify-center gap-3 p-8 text-center",children:[e.jsx("div",{className:"text-muted-foreground",children:e.jsx(D,{className:"size-16",strokeWidth:1.5})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-sm font-medium",children:"No projects found"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Try adjusting your search or create a new project"})]}),e.jsx(p,{variant:"outline",onClick:()=>u(""),className:"mt-2",children:"Clear search"})]}):e.jsx(De,{onCreateClick:E}),e.jsxs(ve,{open:n,onOpenChange:M,title:x?"Edit project":"Create a new project",description:x?"Update your project details":"Create a new project to organize your documents and chats",onSubmit:U,submitLabel:x?"Save Changes":"Create Project",isSubmitting:I||Q,isSubmitDisabled:!c.trim(),children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"project-title",className:"text-foreground text-sm font-medium",children:"Project Title"}),e.jsx(P,{id:"project-title",placeholder:"Enter project title",value:c,onChange:s=>r(s.target.value),autoFocus:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"project-description",className:"text-foreground text-sm font-medium",children:"Description"}),e.jsx(xe,{id:"project-description",placeholder:"Enter project description",value:i,onChange:s=>l(s.target.value),className:"min-h-[100px] resize-none"})]})]}),e.jsx(Ce,{open:j,onOpenChange:d,onConfirm:q,title:"Delete Project",description:`Are you sure you want to delete "${R?.name}"? This action cannot be undone and will permanently remove all associated documents and chats.`,isDeleting:T})]})})}export{Se as ProjectListPage,Se as default};
